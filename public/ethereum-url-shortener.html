<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Making a URL shortener on Ethereum Blockchain">
    <meta property="og:type" content="blog">
  <title>Making a URL shortener on Ethereum Blockchain</title>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
  
</head>

<body>
  <nav class="Navbar">
    <a href="index.html">
      <div class="Navbar__Btn"> <span>Home</span></div>
    </a>
                                                                                                            <span class="Navbar__Delim">&centerdot;</span>
    <a href="about.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F7876a2b8-baaf-4d72-8110-d0cbf017b4ca%2Favatar_small.jpg"></span> <span>About</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="projects.html">
      <div class="Navbar__Btn"><span>👨🏻‍💻</span> <span>Projects</span></div>
    </a>
                                                                                          </nav>
  <header class="Header">
          <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
        <h1 class="Header__Title">Making a URL shortener on Ethereum Blockchain</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted on Sun, Dec 2, 2018</span>
                          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--green">
            <a href="tag/hack.html">hack</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--yellow">
            <a href="tag/ethereum.html">ethereum</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--pink">
            <a href="tag/blockchain.html">blockchain</a>
          </span>
                  </div>
          </header>
      <article id="https://www.notion.so/68b2ad951bff4fcbad3ba7e435204f31" class="PageRoot"><div></div><div id="https://www.notion.so/49bf7445a626486aa7d534d6188876ae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/110c419e002548e1b1976271fd7b4488" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/110c419e002548e1b1976271fd7b4488"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">How it works</span></span></h2><div id="https://www.notion.so/d3f58399cdc54f6293c0d33fdb60f8ba" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fea1d4cd1-8f16-4c4f-80c5-53243dcbf8b4%2F1_e6uPKHACWbRzuaci0bxpXQ.gif?width=626"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fea1d4cd1-8f16-4c4f-80c5-53243dcbf8b4%2F1_e6uPKHACWbRzuaci0bxpXQ.gif?width=626" style="width:626px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/41a22901bc1c46c4a266fe6e9bc38d34" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/056bde50b0b64a44abfd11d921faef45" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/03f50b8d8d76461da5d34272cd0b0fcc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The web app deployed at </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://0x.now.sh/">0x.now.sh</a></span><span class="SemanticString">, interacts with a smart contract deployed on </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://ropsten.etherscan.io/address/0x4b8241f24537d2539d0b310bc074fd68a782e182">Ethereum Ropsten testnet</a></span><span class="SemanticString">. Being on testnet means you can interact with it using free ethers. Get your </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://faucet.metamask.io/">free ethers here</a></span><span class="SemanticString">.</span></span></p></div><h1 id="https://www.notion.so/73cdd275d9f54d129ea6e5fee8839b13" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/73cdd275d9f54d129ea6e5fee8839b13"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">The Process</strong></span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/57008740f584407c984ff70a1b63f6d9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Users make a transaction requesting the blockchain to store a URL string.</span></span></li><li id="https://www.notion.so/af77f4ab53a142abb32a0ca294ede0f6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Since it is a transaction that modifies the state of the blockchain, it needs to have some amount of ethers attached to it so that it can be mined to the blockchain by miners.</span></span></li><li id="https://www.notion.so/996ffbb85aaf4f9992dab56e593ebd2f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">The amount of fee (also called </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.cryptocompare.com/coins/guides/what-is-the-gas-in-ethereum/">gas</a></span><span class="SemanticString">) is determined by the Metamask chrome extension and displayed in the prompt box.</span></span></li><li id="https://www.notion.so/9a58fa4430884a109bf6d8b916ebef34" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">There is some waiting time for the transaction to be confirmed (5–10sec) depending on how busy the blockchain is.</span></span></li><li id="https://www.notion.so/9e36c19ec9cd423e9346e6f146dff2ff" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">The shortened URL is generated. eg </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://0x.now.sh/s?id=23">https://0x.now.sh/s?id=23</a></span></span></li><li id="https://www.notion.so/da838719c4364002bdaf2f8a85eefabe" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">When the users clicks on the shortened URL another transaction is made requesting the blockchain which URL string is located at the provided reference (in this case 23)</span></span></li><li id="https://www.notion.so/b7d31ace2244437ea2bfce91887fe93a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Since this transaction is not changing the state of the blockchain, we do not need to pay any ETH this time, the user is seamlessly redirected to the long URL.</span></span></li></ul><h1 id="https://www.notion.so/d06637f1479246afb440dc4bc1cd12f6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/d06637f1479246afb440dc4bc1cd12f6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">dApp</strong></span></span></h1><div id="https://www.notion.so/4e5b7f4b6478402bb7c01f355ac076d1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Being a Decentralized application means that this web app does not require any centralized database to function. It only interacts with the smart contract deployed on the blockchain.</span></span></p></div><h1 id="https://www.notion.so/aa727e0d1a504d6f8d11934c51eef4f4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/aa727e0d1a504d6f8d11934c51eef4f4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">The SmartContract 📃</strong></span></span></h1><pre id="https://www.notion.so/a7ece85ae85545daad33ed2a82bbf7a4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.24</span><span class="token punctuation">;</span>
contract e0x <span class="token punctuation">{</span>
 event <span class="token function">Log</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span><span class="token punctuation">;</span>
 event <span class="token function">LinkAdded</span><span class="token punctuation">(</span>uint linkId<span class="token punctuation">,</span> string url<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 struct LinkTemplate <span class="token punctuation">{</span>
  address userAddress<span class="token punctuation">;</span>
  string url<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 uint lastLinkId<span class="token punctuation">;</span>
 <span class="token function">mapping</span> <span class="token punctuation">(</span><span class="token parameter">uint</span> <span class="token operator">=></span> LinkTemplate<span class="token punctuation">)</span> <span class="token keyword">public</span> linkMapping<span class="token punctuation">;</span>
 
 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
  lastLinkId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 
 <span class="token keyword">function</span> <span class="token function">createNewLink</span><span class="token punctuation">(</span><span class="token parameter">string url</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     lastLinkId<span class="token operator">++</span><span class="token punctuation">;</span>
  linkMapping<span class="token punctuation">[</span>lastLinkId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">LinkTemplate</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  emit <span class="token function">LinkAdded</span><span class="token punctuation">(</span>lastLinkId<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> lastLinkId<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 modifier <span class="token function">linkExists</span><span class="token punctuation">(</span><span class="token parameter">uint linkId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">//link with the given hash does not exist</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>linkMapping<span class="token punctuation">[</span>linkId<span class="token punctuation">]</span><span class="token punctuation">.</span>userAddress <span class="token operator">==</span> <span class="token number">0x0000000000000000000000000000000000000000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  _<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 <span class="token keyword">function</span> <span class="token function">getLink</span><span class="token punctuation">(</span><span class="token parameter">uint linkId</span><span class="token punctuation">)</span> <span class="token function">linkExists</span><span class="token punctuation">(</span>linkId<span class="token punctuation">)</span> <span class="token keyword">public</span> constant
  <span class="token function">returns</span><span class="token punctuation">(</span>
   <span class="token parameter">address<span class="token punctuation">,</span>
   string</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      LinkTemplate memory link <span class="token operator">=</span> linkMapping<span class="token punctuation">[</span>linkId<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>
    link<span class="token punctuation">.</span>userAddress<span class="token punctuation">,</span>
       link<span class="token punctuation">.</span>url
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/622c57a1c3cb4ce8b2caab9141735e58" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/1cdedff1dbd348a9882ffae2bbbc5963" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/10cb260cbe804422b60029853fdd39ee" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/10cb260cbe804422b60029853fdd39ee"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Technical Challenges</strong></span></span></h1><h1 id="https://www.notion.so/93ae24d314fb499eae2e1a569d9cd0b7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/93ae24d314fb499eae2e1a569d9cd0b7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Interacting with the smart contract</strong></span></span></h1><div id="https://www.notion.so/0e2164902ef44c84b465095a45062d22" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">EthersJS library is used to talk to the blockchain</span></span></p></div><pre id="https://www.notion.so/f96cf17acc4246118b410611960efdc9" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>// provider picks up the Metamask injected web3 object from browser 
let provider = new ethers.providers.Web3Provider(web3.currentProvider);
let address = &quot;ADDRESS_OF_DEPLOYED_SMART_CONTRACT&quot;;
let abi = [...] //defines JSON interface for the smart contract</span></span></span></code></pre><h1 id="https://www.notion.so/fb8a345cb9524ac0953ab492c4df250e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/fb8a345cb9524ac0953ab492c4df250e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Storing data on the blockchain</strong></span></span></h1><pre id="https://www.notion.so/9f0f98fef7784ba9a8ece354a8169e28" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>// calling the createNewLink function defined in the smart contract
tx = await contract.createNewLink(url);
console.log(tx.hash);</span></span></span></code></pre><h1 id="https://www.notion.so/a5d28761a7954d7f8be3543ba41d1480" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a5d28761a7954d7f8be3543ba41d1480"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Listening to blockchain events</strong></span></span></h1><pre id="https://www.notion.so/6d6aff64191c4247b92ffb7e0aff4872" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>contract.on(&quot;LinkAdded&quot;, (linkId, linkUrl) =&gt; {
        
        var shortUrl = &#x27;{0}/s?id={1}&#x27;.f(window.location.origin, linkId.toNumber())
        $(&quot;#info&quot;).prepend( &quot;Short URL: &lt;a href=&#x27;{0}&#x27;&gt;{0}&lt;/a&gt;&lt;br&gt;&quot;.f(shortUrl) );
        
    });</span></span></span></code></pre><h1 id="https://www.notion.so/b4185762c5d04c80a835dd6495253c68" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/b4185762c5d04c80a835dd6495253c68"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Generating the list of recently shortened URLs</strong></span></span></h1><div id="https://www.notion.so/c26b977a42264a6f8a5f97013f4394d0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ced871144f8c497c99c2669ec25edcc6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">EthersJS doe not support batch listening of events so I had to use web3js’s allEvents() function call</span></span></p></div><pre id="https://www.notion.so/5f7656d1b8b4419e9a56bc7ba4301174" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>MyContract = web3.eth.contract(abi);
    myContractInstance = MyContract.at(address);
    events = myContractInstance.allEvents({event: &#x27;LinkAdded&#x27;, fromBlock: 0, toBlock: &#x27;latest&#x27;});
    events.watch(function(error, result){
      console.log(result.args.url, result.args.linkId.toNumber());
      ...
});</span></span></span></code></pre><h1 id="https://www.notion.so/117f90ba771747b08d316d13b93fd192" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/117f90ba771747b08d316d13b93fd192"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Making the shortened URLs accessible in all Browsers</strong></span></span></h1><div id="https://www.notion.so/b2cdc04f59fa4043a5522653273717a2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/654f49c1b6aa4cc188b5180d42e7fd55" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This was quite tricky because interacting with blockchain required the browser to be web3 enabled, and have some wallet installed (metamask or similar). Currently web3 and wallet support is only for Chrome and Firefox on Desktop only.</span></span></p></div><div id="https://www.notion.so/d007804e8f44464ab25ee7adeefafcce" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">To solve this, I had to create a wallet on the fly as follows</span></span></p></div><pre id="https://www.notion.so/f3dd0f87609b4d749e94b3812c254eae" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>provider = ethers.getDefaultProvider(&#x27;ropsten&#x27;);
wallet = ethers.Wallet.createRandom();
wallet = wallet.connect(provider);</span></span></span></code></pre><div id="https://www.notion.so/1803582c03184034a891d95c4ee477ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Shout out to the awesome </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/ethers-io/ethers.js/">ethersJS library</a></span><span class="SemanticString"> for having support for this.</span></span></p></div><h1 id="https://www.notion.so/bb1a4842d99c4409897627c9459eaea0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/bb1a4842d99c4409897627c9459eaea0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Counting URL visits</strong></span></span></h1><div id="https://www.notion.so/a4de286ddf1c4ae4a7ff705fc1a7219c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The flexibility for using this one all browsers comes at a cost. Each time user clicks on the shortened URL no change is made to the blockchain state, hence it is not possible to determine how many times each link was clicked. This issues remains unsolved.</span></span></p></div><div id="https://www.notion.so/d1d9f41aaf6f48ee8cbee34843ef097b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The complete source code for this project is on </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/sauravtom/ethereum-url-shortener">Github</a></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/87a8192dc0964d46a5b7ef8eb6a09ea2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Pull Requests welcome 😁</span></span></p></div><div id="https://www.notion.so/bf12b1a9e97d49a5a78bd69badfd20dd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
        <!-- <div>&copy; Saurav's blog 2020</div> -->
        <div id="graphcomment"></div>
    </footer>
</body>

<!-- GRAPH COMMENTS WIDGET -->
<script type="text/javascript">

  /* - - - CONFIGURATION VARIABLES - - - */

  // make sure the id is yours
  window.gc_params = {
    graphcomment_id: 'Personal-Blog',

    // if your website has a fixed header, indicate it's height in pixels
    fixed_header_height: 0,
  };

  /* - - - DON'T EDIT BELOW THIS LINE - - - */

  
  (function() {
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.src = 'https://graphcomment.com/js/integration.js?' + Math.round(Math.random() * 1e8);
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();

</script>

<!--GOAT COUNTER WIDGET-->
<script data-goatcounter="https://tom1729.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-170884966-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-170884966-1');
</script>


</html>